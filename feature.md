# 二维码扫描导入功能

## 功能概述

转盘应用新增了二维码扫描导入功能，用户可以通过扫描其他用户分享的二维码来快速导入转盘数据。

## 功能特性

### 1. 扫描界面

- 美观的全屏扫描界面
- 清晰的扫描框引导用户对准二维码
- 实时相机预览
- 权限请求和错误处理

### 2. 数据处理

- 自动验证二维码数据格式
- 检查转盘名称和选项的有效性
- 自动处理重名转盘（添加序号）
- 生成新的转盘和选项 ID

### 3. 用户体验

- 扫描成功后自动跳转到转盘页面
- 持续自动扫描，无需手动操作
- 简洁的界面，无多余提示
- 权限被拒绝时的引导
- 扫描失败时自动继续扫描

## 使用方法

### 扫描二维码

1. 在转盘列表页面点击"扫描导入"按钮
2. 允许应用使用相机权限
3. 将二维码对准扫描框
4. 扫描成功后转盘会自动导入并跳转到转盘页面

### 分享二维码

1. 在转盘列表页面点击转盘的分享按钮
2. 查看生成的二维码
3. 其他用户可以通过扫描此二维码导入转盘

## 技术实现

### 组件结构

- `ScanModal.tsx`: 扫描模态框组件
- `ShareModal.tsx`: 分享模态框组件
- `list.tsx`: 列表页面（集成扫描功能）

### 数据格式

二维码包含的 JSON 数据格式：

```json
{
  "name": "转盘名称",
  "options": [
    { "id": "opt-1", "text": "选项1" },
    { "id": "opt-2", "text": "选项2" }
  ],
  "version": "1.0.0",
  "timestamp": 1234567890
}
```

### 权限配置

在 `app.json` 中配置了相机权限：

```json
{
  "expo-camera": {
    "cameraPermission": "允许应用使用相机来扫描二维码"
  }
}
```

### 技术更新

- 使用 `expo-camera` 替代已弃用的 `expo-barcode-scanner`
- 使用 `CameraView` 组件进行二维码扫描
- 支持最新的 Expo SDK 53
- 更新 React Navigation 依赖，修复 pointerEvents 弃用警告

## 错误处理

### 常见错误

1. **权限被拒绝**: 显示权限说明和关闭按钮
2. **无效数据格式**: 提示"无效的二维码数据格式"
3. **选项数据无效**: 提示"转盘选项数据无效"
4. **解析失败**: 提示"无法解析二维码数据"

### 重名处理

- 自动检测重名转盘
- 在转盘名称后添加序号，如"转盘名称 (1)"
- 递增序号直到找到唯一名称

## 版本信息

- **版本**: v1.0.3
- **新增功能**: 二维码扫描导入
- **依赖**: expo-camera
- **技术更新**: 修复 expo-barcode-scanner 弃用问题
